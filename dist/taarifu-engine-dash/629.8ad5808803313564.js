"use strict";(self.webpackChunktaarifu_engine_dash=self.webpackChunktaarifu_engine_dash||[]).push([[629],{629:($,F,a)=>{a.r(F),a.d(F,{ConstituencyFormComponent:()=>T});var p=a(177),o=a(4341),u=a(1069),e=a(4438),_=a(9118),b=a(5996),C=a(3446),k=a(5423);function I(n,s){1&n&&(e.j41(0,"div",51),e.EFF(1," Constituency name is required "),e.k0s())}function S(n,s){1&n&&(e.j41(0,"div",51),e.EFF(1," Constituency name must not exceed 100 characters "),e.k0s())}function j(n,s){if(1&n&&(e.j41(0,"option",52),e.EFF(1),e.k0s()),2&n){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function R(n,s){1&n&&(e.j41(0,"div",51),e.EFF(1," Please select a region "),e.k0s())}function q(n,s){if(1&n&&(e.j41(0,"option",52),e.EFF(1),e.k0s()),2&n){const t=s.$implicit;e.Y8G("value",t.id),e.R7$(),e.JRh(t.name)}}function P(n,s){1&n&&(e.j41(0,"div",51),e.EFF(1," Please select a district "),e.k0s())}function A(n,s){1&n&&(e.j41(0,"div",51),e.EFF(1," Headquarters is required "),e.k0s())}function D(n,s){1&n&&(e.j41(0,"div",51),e.EFF(1," Headquarters must not exceed 100 characters "),e.k0s())}function M(n,s){1&n&&e.nrm(0,"span",53)}function O(n,s){1&n&&e.nrm(0,"i",54)}let T=(()=>{class n{constructor(t,r,i,c,d,m,l){this.fb=t,this.route=r,this.router=i,this.constituencyService=c,this.regionService=d,this.districtService=m,this.toastService=l,this.isEditMode=!1,this.isSubmitting=!1,this.constituencyId=null,this.regions=[],this.districts=[],this.constituencyForm=this.createForm()}ngOnInit(){this.loadRegions(),this.route.params.subscribe(t=>{t.uid&&(this.isEditMode=!0,this.constituencyId=t.uid,this.loadConstituency())})}createForm(){return this.fb.group({name:["",[o.k0.required,o.k0.maxLength(100)]],regionId:["",o.k0.required],districtId:["",o.k0.required],headquarters:["",[o.k0.required,o.k0.maxLength(100)]],population:[null],areaSqKm:[null],latitude:[null],longitude:[null],description:[""],isActive:[!0]})}loadRegions(){this.regionService.getAllRegions(0,1e3).subscribe({next:t=>{t.status?this.regions=t.data:this.toastService.error("Error","Failed to load regions")},error:t=>{console.error("Error loading regions:",t),this.toastService.error("Error","Failed to load regions. Please try again.")}})}onRegionChange(){const t=this.constituencyForm.get("regionId")?.value;if(this.constituencyForm.get("districtId")?.setValue(""),this.districts=[],t){const r=this.regions.find(i=>i.id===Number(t));r&&this.districtService.getDistrictsByRegionUid(r.uid,0,1e3).subscribe({next:i=>{i.status?this.districts=i.data:this.toastService.error("Error","Failed to load districts")},error:i=>{console.error("Error loading districts:",i),this.toastService.error("Error","Failed to load districts. Please try again.")}})}}loadConstituency(){this.constituencyId&&this.constituencyService.getConstituencyByUid(this.constituencyId).subscribe({next:t=>{if(t.status){const r=t.data;this.constituencyForm.patchValue({name:r.name,regionId:r.regionId,districtId:r.districtId,headquarters:r.headquarters,population:r.population,areaSqKm:r.areaSqKm,latitude:r.latitude,longitude:r.longitude,description:r.description,isActive:r.isActive}),r.regionId&&this.onRegionChange()}else this.toastService.error("Error","Failed to load constituency"),this.router.navigate(["/constituencies"])},error:t=>{console.error("Error loading constituency:",t),this.toastService.error("Error","Failed to load constituency. Please try again."),this.router.navigate(["/constituencies"])}})}onSubmit(){if(this.constituencyForm.valid){this.isSubmitting=!0;const t=this.constituencyForm.value;this.isEditMode&&this.constituencyId?this.constituencyService.updateConstituency(this.constituencyId,{name:t.name,districtId:t.districtId,headquarters:t.headquarters,population:t.population,areaSqKm:t.areaSqKm,latitude:t.latitude,longitude:t.longitude,description:t.description,isActive:t.isActive}).subscribe({next:i=>{this.isSubmitting=!1,i.status?(this.toastService.success("Success","Constituency updated successfully"),this.router.navigate(["/constituencies"])):this.toastService.error("Error","Failed to update constituency")},error:i=>{this.isSubmitting=!1,console.error("Error updating constituency:",i),this.toastService.error("Error","Failed to update constituency. Please try again.")}}):this.constituencyService.createConstituency({name:t.name,districtId:t.districtId,headquarters:t.headquarters,population:t.population,areaSqKm:t.areaSqKm,latitude:t.latitude,longitude:t.longitude,description:t.description,isActive:t.isActive}).subscribe({next:i=>{this.isSubmitting=!1,i.status?(this.toastService.success("Success","Constituency created successfully"),this.router.navigate(["/constituencies"])):this.toastService.error("Error","Failed to create constituency")},error:i=>{this.isSubmitting=!1,console.error("Error creating constituency:",i),this.toastService.error("Error","Failed to create constituency. Please try again.")}})}else this.toastService.warning("Validation Error","Please fill in all required fields correctly"),this.constituencyForm.markAllAsTouched()}static{this.\u0275fac=function(r){return new(r||n)(e.rXU(o.ok),e.rXU(u.nX),e.rXU(u.Ix),e.rXU(_.w),e.rXU(b.S),e.rXU(C.m),e.rXU(k.f))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-constituency-form"]],standalone:!0,features:[e.aNF],decls:133,vars:23,consts:[[1,"constituency-form-container"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"h3","mb-1"],[1,"text-muted"],["type","button","routerLink","/constituencies",1,"btn","btn-outline-secondary"],[1,"bi","bi-arrow-left","me-1"],[1,"row"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"bi","bi-flag","me-2"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-md-6"],["for","name",1,"form-label"],[1,"text-danger"],["type","text","id","name","formControlName","name","placeholder","Enter constituency name",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","regionId",1,"form-label"],["id","regionId","formControlName","regionId",1,"form-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","districtId",1,"form-label"],["id","districtId","formControlName","districtId",1,"form-select"],["for","headquarters",1,"form-label"],["type","text","id","headquarters","formControlName","headquarters","placeholder","Enter headquarters",1,"form-control"],["for","population",1,"form-label"],["type","number","id","population","formControlName","population","placeholder","Enter population","min","0",1,"form-control"],["for","areaSqKm",1,"form-label"],["type","number","id","areaSqKm","formControlName","areaSqKm","placeholder","Enter area in square kilometers","min","0","step","0.01",1,"form-control"],["for","latitude",1,"form-label"],["type","number","id","latitude","formControlName","latitude","placeholder","Enter latitude","step","0.000001",1,"form-control"],["for","longitude",1,"form-label"],["type","number","id","longitude","formControlName","longitude","placeholder","Enter longitude","step","0.000001",1,"form-control"],[1,"col-12"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","3","placeholder","Enter constituency description",1,"form-control"],[1,"form-check"],["type","checkbox","id","isActive","formControlName","isActive",1,"form-check-input"],["for","isActive",1,"form-check-label"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],["class","bi bi-check-circle me-1",4,"ngIf"],[1,"col-lg-4"],[1,"bi","bi-info-circle","me-2"],[1,"list-unstyled"],[1,"bi","bi-check-circle","text-success","me-2"],[1,"bi","bi-lightbulb","text-warning","me-2"],[1,"invalid-feedback"],[3,"value"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-check-circle","me-1"]],template:function(r,i){if(1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4),e.k0s(),e.j41(5,"p",3),e.EFF(6),e.k0s()(),e.j41(7,"button",4),e.nrm(8,"i",5),e.EFF(9," Back to List "),e.k0s()(),e.j41(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"h5",10),e.nrm(15,"i",11),e.EFF(16," Constituency Information "),e.k0s()(),e.j41(17,"div",12)(18,"form",13),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(19,"div",14)(20,"div",15)(21,"label",16),e.EFF(22,"Constituency Name "),e.j41(23,"span",17),e.EFF(24,"*"),e.k0s()(),e.nrm(25,"input",18),e.DNE(26,I,2,0,"div",19)(27,S,2,0,"div",19),e.k0s(),e.j41(28,"div",15)(29,"label",20),e.EFF(30,"Region "),e.j41(31,"span",17),e.EFF(32,"*"),e.k0s()(),e.j41(33,"select",21),e.bIt("change",function(){return i.onRegionChange()}),e.j41(34,"option",22),e.EFF(35,"Select a region"),e.k0s(),e.DNE(36,j,2,2,"option",23),e.k0s(),e.DNE(37,R,2,0,"div",19),e.k0s(),e.j41(38,"div",15)(39,"label",24),e.EFF(40,"District "),e.j41(41,"span",17),e.EFF(42,"*"),e.k0s()(),e.j41(43,"select",25)(44,"option",22),e.EFF(45,"Select a district"),e.k0s(),e.DNE(46,q,2,2,"option",23),e.k0s(),e.DNE(47,P,2,0,"div",19),e.k0s(),e.j41(48,"div",15)(49,"label",26),e.EFF(50,"Headquarters "),e.j41(51,"span",17),e.EFF(52,"*"),e.k0s()(),e.nrm(53,"input",27),e.DNE(54,A,2,0,"div",19)(55,D,2,0,"div",19),e.k0s(),e.j41(56,"div",15)(57,"label",28),e.EFF(58,"Population"),e.k0s(),e.nrm(59,"input",29),e.k0s(),e.j41(60,"div",15)(61,"label",30),e.EFF(62,"Area (km\xb2)"),e.k0s(),e.nrm(63,"input",31),e.k0s(),e.j41(64,"div",15)(65,"label",32),e.EFF(66,"Latitude"),e.k0s(),e.nrm(67,"input",33),e.k0s(),e.j41(68,"div",15)(69,"label",34),e.EFF(70,"Longitude"),e.k0s(),e.nrm(71,"input",35),e.k0s(),e.j41(72,"div",36)(73,"label",37),e.EFF(74,"Description"),e.k0s(),e.nrm(75,"textarea",38),e.k0s(),e.j41(76,"div",36)(77,"div",39),e.nrm(78,"input",40),e.j41(79,"label",41),e.EFF(80," Active Constituency "),e.k0s()()(),e.j41(81,"div",36)(82,"div",42)(83,"button",43),e.DNE(84,M,1,0,"span",44)(85,O,1,0,"i",45),e.EFF(86),e.k0s(),e.j41(87,"button",4),e.EFF(88," Cancel "),e.k0s()()()()()()()(),e.j41(89,"div",46)(90,"div",8)(91,"div",9)(92,"h5",10),e.nrm(93,"i",47),e.EFF(94," Guidelines "),e.k0s()(),e.j41(95,"div",12)(96,"h6"),e.EFF(97,"Creating a Constituency"),e.k0s(),e.j41(98,"ul",48)(99,"li"),e.nrm(100,"i",49),e.EFF(101,"Provide a unique constituency name"),e.k0s(),e.j41(102,"li"),e.nrm(103,"i",49),e.EFF(104,"Select the appropriate region"),e.k0s(),e.j41(105,"li"),e.nrm(106,"i",49),e.EFF(107,"Specify the headquarters location"),e.k0s(),e.j41(108,"li"),e.nrm(109,"i",49),e.EFF(110,"Add population and area data if available"),e.k0s(),e.j41(111,"li"),e.nrm(112,"i",49),e.EFF(113,"Include coordinates for mapping"),e.k0s(),e.j41(114,"li"),e.nrm(115,"i",49),e.EFF(116,"Add the Member of Parliament name"),e.k0s()(),e.nrm(117,"hr"),e.j41(118,"h6"),e.EFF(119,"Best Practices"),e.k0s(),e.j41(120,"ul",48)(121,"li"),e.nrm(122,"i",50),e.EFF(123,"Use clear, descriptive names"),e.k0s(),e.j41(124,"li"),e.nrm(125,"i",50),e.EFF(126,"Ensure headquarters is accurate"),e.k0s(),e.j41(127,"li"),e.nrm(128,"i",50),e.EFF(129,"Verify region selection"),e.k0s(),e.j41(130,"li"),e.nrm(131,"i",50),e.EFF(132,"Include relevant description"),e.k0s()()()()()()()),2&r){let c,d,m,l,f,g,v,h,y,E;e.R7$(4),e.JRh(i.isEditMode?"Edit Constituency":"Create New Constituency"),e.R7$(2),e.JRh(i.isEditMode?"Update constituency information":"Add a new constituency to the system"),e.R7$(12),e.Y8G("formGroup",i.constituencyForm),e.R7$(7),e.AVh("is-invalid",(null==(c=i.constituencyForm.get("name"))?null:c.invalid)&&(null==(c=i.constituencyForm.get("name"))?null:c.touched)),e.R7$(),e.Y8G("ngIf",null==(d=i.constituencyForm.get("name"))?null:d.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(m=i.constituencyForm.get("name"))?null:m.hasError("maxlength")),e.R7$(6),e.AVh("is-invalid",(null==(l=i.constituencyForm.get("regionId"))?null:l.invalid)&&(null==(l=i.constituencyForm.get("regionId"))?null:l.touched)),e.R7$(3),e.Y8G("ngForOf",i.regions),e.R7$(),e.Y8G("ngIf",null==(f=i.constituencyForm.get("regionId"))?null:f.hasError("required")),e.R7$(6),e.AVh("is-invalid",(null==(g=i.constituencyForm.get("districtId"))?null:g.invalid)&&(null==(g=i.constituencyForm.get("districtId"))?null:g.touched)),e.R7$(3),e.Y8G("ngForOf",i.districts),e.R7$(),e.Y8G("ngIf",null==(v=i.constituencyForm.get("districtId"))?null:v.hasError("required")),e.R7$(6),e.AVh("is-invalid",(null==(h=i.constituencyForm.get("headquarters"))?null:h.invalid)&&(null==(h=i.constituencyForm.get("headquarters"))?null:h.touched)),e.R7$(),e.Y8G("ngIf",null==(y=i.constituencyForm.get("headquarters"))?null:y.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(E=i.constituencyForm.get("headquarters"))?null:E.hasError("maxlength")),e.R7$(28),e.Y8G("disabled",i.constituencyForm.invalid||i.isSubmitting),e.R7$(),e.Y8G("ngIf",i.isSubmitting),e.R7$(),e.Y8G("ngIf",!i.isSubmitting),e.R7$(),e.SpI(" ",i.isSubmitting?"Saving...":i.isEditMode?"Update Constituency":"Create Constituency"," ")}},dependencies:[p.MD,p.Sq,p.bT,o.X1,o.qT,o.xH,o.y7,o.me,o.Q0,o.Zm,o.wz,o.BC,o.cb,o.VZ,o.j4,o.JD,u.iI,u.Wk],styles:[".constituency-form-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 1rem}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #dee2e6}.form-label[_ngcontent-%COMP%]{font-weight:500}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}"]})}}return n})()}}]);