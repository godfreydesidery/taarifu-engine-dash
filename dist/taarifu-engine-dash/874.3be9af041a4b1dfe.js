"use strict";(self.webpackChunktaarifu_engine_dash=self.webpackChunktaarifu_engine_dash||[]).push([[874],{874:(C,p,n)=>{n.r(p),n.d(p,{DistrictFormComponent:()=>j});var u=n(177),r=n(4341),i=n(4438),F=n(3446),f=n(5996),g=n(1069),v=n(5423);function E(s,d){1&s&&(i.j41(0,"div",48),i.EFF(1," District name is required "),i.k0s())}function b(s,d){1&s&&(i.j41(0,"div",48),i.EFF(1," District name must not exceed 100 characters "),i.k0s())}function k(s,d){if(1&s&&(i.j41(0,"option",49),i.EFF(1),i.k0s()),2&s){const e=d.$implicit;i.Y8G("value",e.id),i.R7$(),i.JRh(e.name)}}function _(s,d){1&s&&(i.j41(0,"div",48),i.EFF(1," Region is required "),i.k0s())}function D(s,d){1&s&&i.nrm(0,"span",50)}let j=(()=>{class s{constructor(e,o,t,a,l,c){this.fb=e,this.districtService=o,this.regionService=t,this.router=a,this.route=l,this.toastService=c,this.isEditMode=!1,this.isLoading=!1,this.districtId=null,this.regions=[],this.districtForm=this.fb.group({name:["",[r.k0.required,r.k0.maxLength(100)]],regionId:[null,[r.k0.required]],headquarters:["",[r.k0.maxLength(100)]],population:[null,[r.k0.min(0)]],areaSqKm:[null,[r.k0.min(0)]],latitude:[null],longitude:[null],description:["",[r.k0.maxLength(500)]],isActive:[!0]})}ngOnInit(){this.districtId=this.route.snapshot.paramMap.get("uid"),this.isEditMode=!!this.districtId,this.loadRegions(),this.isEditMode&&this.districtId&&this.loadDistrict(this.districtId)}loadRegions(){this.regionService.getActiveRegions(0,1e3).subscribe({next:e=>{this.regions=e.data||[]},error:e=>{console.error("Error loading regions:",e),this.regions=[]}})}loadDistrict(e){this.isLoading=!0,this.districtService.getDistrictByUid(e).subscribe({next:o=>{if(this.isLoading=!1,o.status){const t=o.data;this.districtForm.patchValue({name:t.name,regionId:t.regionId,headquarters:t.headquarters,population:t.population,areaSqKm:t.areaSqKm,latitude:t.latitude,longitude:t.longitude,description:t.description,isActive:t.isActive})}},error:o=>{this.isLoading=!1,console.error("Error loading district:",o),this.toastService.error("Error Loading District",o.error?.message||o.message||"Unknown error"),this.goBack()}})}onSubmit(){if(this.districtForm.valid){this.isLoading=!0;const e=this.districtForm.value;this.isEditMode&&this.districtId?this.districtService.updateDistrict(this.districtId,{name:e.name,headquarters:e.headquarters,population:e.population,areaSqKm:e.areaSqKm,latitude:e.latitude,longitude:e.longitude,description:e.description,isActive:e.isActive}).subscribe({next:t=>{this.isLoading=!1,t.status&&(this.toastService.success("District Updated","District updated successfully!"),this.goBack())},error:t=>{this.isLoading=!1,console.error("Error updating district:",t),this.toastService.error("Error Updating District","Failed to update district")}}):this.districtService.createDistrict({name:e.name,regionId:e.regionId,headquarters:e.headquarters,population:e.population,areaSqKm:e.areaSqKm,latitude:e.latitude,longitude:e.longitude,description:e.description,isActive:e.isActive}).subscribe({next:t=>{this.isLoading=!1,t.status&&(this.toastService.success("District Created","District created successfully!"),this.goBack())},error:t=>{this.isLoading=!1,console.error("Error creating district:",t),this.toastService.error("Error Creating District","Failed to create district")}})}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.districtForm.controls).forEach(e=>{this.districtForm.get(e)?.markAsTouched()})}goBack(){this.router.navigate(["/districts"])}static{this.\u0275fac=function(o){return new(o||s)(i.rXU(r.ok),i.rXU(F.m),i.rXU(f.S),i.rXU(g.Ix),i.rXU(g.nX),i.rXU(v.f))}}static{this.\u0275cmp=i.VBU({type:s,selectors:[["app-district-form"]],standalone:!0,features:[i.aNF],decls:130,vars:14,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"h3","mb-1"],[1,"text-muted"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi","bi-arrow-left","me-1"],[1,"row"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"bi","bi-building","me-2"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"mb-3"],["for","name",1,"form-label"],[1,"text-danger"],["type","text","id","name","formControlName","name","placeholder","Enter district name",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","regionId",1,"form-label"],["id","regionId","formControlName","regionId",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","headquarters",1,"form-label"],["type","text","id","headquarters","formControlName","headquarters","placeholder","Enter headquarters",1,"form-control"],[1,"form-label"],[1,"form-check","form-switch"],["type","checkbox","id","isActive","formControlName","isActive",1,"form-check-input"],["for","isActive",1,"form-check-label"],["for","population",1,"form-label"],["type","number","id","population","formControlName","population","min","0","placeholder","Enter population",1,"form-control"],["for","areaSqKm",1,"form-label"],["type","number","id","areaSqKm","formControlName","areaSqKm","min","0","step","0.01","placeholder","Enter area in square kilometers",1,"form-control"],["for","latitude",1,"form-label"],["type","number","id","latitude","formControlName","latitude","step","0.000001","placeholder","Enter latitude",1,"form-control"],["for","longitude",1,"form-label"],["type","number","id","longitude","formControlName","longitude","step","0.000001","placeholder","Enter longitude",1,"form-control"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","3","placeholder","Enter district description",1,"form-control"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[1,"col-lg-4"],[1,"bi","bi-info-circle","me-2"],[1,"list-unstyled","small","text-muted"],[1,"mt-3"],[1,"invalid-feedback"],[3,"value"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(o,t){if(1&o&&(i.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),i.EFF(4),i.k0s(),i.j41(5,"p",3),i.EFF(6),i.k0s()(),i.j41(7,"button",4),i.bIt("click",function(){return t.goBack()}),i.nrm(8,"i",5),i.EFF(9," Back "),i.k0s()(),i.j41(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"h5",10),i.nrm(15,"i",11),i.EFF(16," District Information "),i.k0s()(),i.j41(17,"div",12)(18,"form",13),i.bIt("ngSubmit",function(){return t.onSubmit()}),i.j41(19,"div",6)(20,"div",14)(21,"div",15)(22,"label",16),i.EFF(23,"District Name "),i.j41(24,"span",17),i.EFF(25,"*"),i.k0s()(),i.nrm(26,"input",18),i.DNE(27,E,2,0,"div",19)(28,b,2,0,"div",19),i.k0s()(),i.j41(29,"div",14)(30,"div",15)(31,"label",20),i.EFF(32,"Region "),i.j41(33,"span",17),i.EFF(34,"*"),i.k0s()(),i.j41(35,"select",21)(36,"option",22),i.EFF(37,"Select a region"),i.k0s(),i.DNE(38,k,2,2,"option",23),i.k0s(),i.DNE(39,_,2,0,"div",19),i.k0s()()(),i.j41(40,"div",6)(41,"div",14)(42,"div",15)(43,"label",24),i.EFF(44,"Headquarters"),i.k0s(),i.nrm(45,"input",25),i.k0s()(),i.j41(46,"div",14)(47,"div",15)(48,"label",26),i.EFF(49,"Status"),i.k0s(),i.j41(50,"div",27),i.nrm(51,"input",28),i.j41(52,"label",29),i.EFF(53," Active "),i.k0s()()()()(),i.j41(54,"div",6)(55,"div",14)(56,"div",15)(57,"label",30),i.EFF(58,"Population"),i.k0s(),i.nrm(59,"input",31),i.k0s()(),i.j41(60,"div",14)(61,"div",15)(62,"label",32),i.EFF(63,"Area (km\xb2)"),i.k0s(),i.nrm(64,"input",33),i.k0s()()(),i.j41(65,"div",6)(66,"div",14)(67,"div",15)(68,"label",34),i.EFF(69,"Latitude"),i.k0s(),i.nrm(70,"input",35),i.k0s()(),i.j41(71,"div",14)(72,"div",15)(73,"label",36),i.EFF(74,"Longitude"),i.k0s(),i.nrm(75,"input",37),i.k0s()()(),i.j41(76,"div",15)(77,"label",38),i.EFF(78,"Description"),i.k0s(),i.nrm(79,"textarea",39),i.k0s(),i.j41(80,"div",40)(81,"button",41),i.bIt("click",function(){return t.goBack()}),i.EFF(82," Cancel "),i.k0s(),i.j41(83,"button",42),i.DNE(84,D,1,0,"span",43),i.EFF(85),i.k0s()()()()()(),i.j41(86,"div",44)(87,"div",8)(88,"div",9)(89,"h6",10),i.nrm(90,"i",45),i.EFF(91," Help & Guidelines "),i.k0s()(),i.j41(92,"div",12)(93,"h6"),i.EFF(94,"Required Fields"),i.k0s(),i.j41(95,"ul",46)(96,"li"),i.EFF(97,"\u2022 District Name"),i.k0s(),i.j41(98,"li"),i.EFF(99,"\u2022 Region"),i.k0s(),i.j41(100,"li"),i.EFF(101,"\u2022 Headquarters"),i.k0s(),i.j41(102,"li"),i.EFF(103,"\u2022 Commissioner"),i.k0s()(),i.j41(104,"h6",47),i.EFF(105,"Optional Fields"),i.k0s(),i.j41(106,"ul",46)(107,"li"),i.EFF(108,"\u2022 Population"),i.k0s(),i.j41(109,"li"),i.EFF(110,"\u2022 Area (km\xb2)"),i.k0s(),i.j41(111,"li"),i.EFF(112,"\u2022 Coordinates (Latitude/Longitude)"),i.k0s(),i.j41(113,"li"),i.EFF(114,"\u2022 Description"),i.k0s()(),i.j41(115,"h6",47),i.EFF(116,"Tips"),i.k0s(),i.j41(117,"ul",46)(118,"li"),i.EFF(119,"\u2022 Select the correct region first"),i.k0s(),i.j41(120,"li"),i.EFF(121,"\u2022 Use official district names"),i.k0s(),i.j41(122,"li"),i.EFF(123,"\u2022 Headquarters should be the main town"),i.k0s(),i.j41(124,"li"),i.EFF(125,"\u2022 Use precise coordinates for mapping"),i.k0s(),i.j41(126,"li"),i.EFF(127,"\u2022 Population should be current estimates"),i.k0s(),i.j41(128,"li"),i.EFF(129,"\u2022 Keep descriptions concise and informative"),i.k0s()()()()()()()),2&o){let a,l,c,m,h;i.R7$(4),i.JRh(t.isEditMode?"Edit District":"Create District"),i.R7$(2),i.JRh(t.isEditMode?"Update district information":"Add a new district to the system"),i.R7$(12),i.Y8G("formGroup",t.districtForm),i.R7$(8),i.AVh("is-invalid",(null==(a=t.districtForm.get("name"))?null:a.invalid)&&(null==(a=t.districtForm.get("name"))?null:a.touched)),i.R7$(),i.Y8G("ngIf",null==(l=t.districtForm.get("name"))?null:l.hasError("required")),i.R7$(),i.Y8G("ngIf",null==(c=t.districtForm.get("name"))?null:c.hasError("maxlength")),i.R7$(7),i.AVh("is-invalid",(null==(m=t.districtForm.get("regionId"))?null:m.invalid)&&(null==(m=t.districtForm.get("regionId"))?null:m.touched)),i.R7$(3),i.Y8G("ngForOf",t.regions),i.R7$(),i.Y8G("ngIf",null==(h=t.districtForm.get("regionId"))?null:h.hasError("required")),i.R7$(44),i.Y8G("disabled",t.districtForm.invalid||t.isLoading),i.R7$(),i.Y8G("ngIf",t.isLoading),i.R7$(),i.SpI(" ",t.isLoading?"Saving...":t.isEditMode?"Update District":"Create District"," ")}},dependencies:[u.MD,u.Sq,u.bT,r.X1,r.qT,r.xH,r.y7,r.me,r.Q0,r.Zm,r.wz,r.BC,r.cb,r.VZ,r.j4,r.JD],styles:[".container-fluid[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 1rem}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #dee2e6}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#495057}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}"]})}}return s})()}}]);