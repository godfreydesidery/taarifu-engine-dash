"use strict";(self.webpackChunktaarifu_engine_dash=self.webpackChunktaarifu_engine_dash||[]).push([[705],{3705:(k,g,c)=>{c.r(g),c.d(g,{ConstituencyListComponent:()=>E});var l=c(177),a=c(4341),d=c(1069),t=c(4438),h=c(9118),_=c(8010),m=c(5423);const p=s=>["/constituencies/edit",s];function b(s,u){1&s&&(t.j41(0,"div",23)(1,"div",24)(2,"span",25),t.EFF(3,"Loading..."),t.k0s()(),t.j41(4,"p",26),t.EFF(5,"Loading constituencies..."),t.k0s()())}function v(s,u){1&s&&(t.j41(0,"div",27),t.nrm(1,"i",28),t.j41(2,"h4",29),t.EFF(3,"No constituencies found"),t.k0s(),t.j41(4,"p",30),t.EFF(5,"Start by creating your first constituency."),t.k0s(),t.j41(6,"a",31),t.nrm(7,"i",32),t.EFF(8," Add Constituency "),t.k0s()())}function y(s,u){if(1&s){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"span",39),t.EFF(3),t.k0s()(),t.j41(4,"td")(5,"div")(6,"strong"),t.EFF(7),t.k0s(),t.nrm(8,"br"),t.j41(9,"small",30),t.EFF(10),t.k0s()()(),t.j41(11,"td"),t.EFF(12),t.k0s(),t.j41(13,"td")(14,"span",40),t.EFF(15),t.k0s()(),t.j41(16,"td")(17,"span",41),t.EFF(18),t.k0s()(),t.j41(19,"td"),t.EFF(20),t.nI1(21,"number"),t.k0s(),t.j41(22,"td"),t.EFF(23),t.nI1(24,"number"),t.k0s(),t.j41(25,"td")(26,"span",42),t.EFF(27),t.k0s()(),t.j41(28,"td")(29,"div",43)(30,"button",44),t.nrm(31,"i",45),t.k0s(),t.j41(32,"button",46),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.deleteConstituency(n))}),t.nrm(33,"i",47),t.k0s()()()()}if(2&s){const e=u.$implicit;t.R7$(3),t.JRh(e.code),t.R7$(4),t.JRh(e.name),t.R7$(3),t.JRh(e.description||"No description"),t.R7$(2),t.JRh(e.headquarters),t.R7$(3),t.JRh(e.districtName),t.R7$(3),t.JRh(e.regionName),t.R7$(2),t.JRh(t.bMT(21,14,e.population)),t.R7$(3),t.JRh(t.i5U(24,16,e.areaSqKm,"1.1-1")),t.R7$(3),t.AVh("bg-success",e.isActive)("bg-danger",!e.isActive),t.R7$(),t.SpI(" ",e.isActive?"Active":"Inactive"," "),t.R7$(3),t.Y8G("routerLink",t.eq3(19,p,e.uid))}}function f(s,u){if(1&s){const e=t.RV6();t.j41(0,"div",33)(1,"table",34)(2,"thead",35)(3,"tr")(4,"th",36),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.onSort("code",n))}),t.EFF(5," Code "),t.nrm(6,"i",37),t.k0s(),t.j41(7,"th",36),t.bIt("click",function(n){t.eBV(e);const o=t.XpG();return t.Njj(o.onSort("name",n))}),t.EFF(8," Name "),t.nrm(9,"i",37),t.k0s(),t.j41(10,"th"),t.EFF(11,"Headquarters"),t.k0s(),t.j41(12,"th"),t.EFF(13,"District"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Region"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Population"),t.k0s(),t.j41(18,"th"),t.EFF(19,"Area (km\xb2)"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Status"),t.k0s(),t.j41(22,"th"),t.EFF(23,"Actions"),t.k0s()()(),t.j41(24,"tbody"),t.DNE(25,y,34,21,"tr",38),t.k0s()()()}if(2&s){const e=t.XpG();t.R7$(6),t.AVh("bi-arrow-up","code"===e.sortBy&&"asc"===e.sortDir)("bi-arrow-down","code"===e.sortBy&&"desc"===e.sortDir),t.R7$(3),t.AVh("bi-arrow-up","name"===e.sortBy&&"asc"===e.sortDir)("bi-arrow-down","name"===e.sortBy&&"desc"===e.sortDir),t.R7$(16),t.Y8G("ngForOf",e.constituencies)}}function C(s,u){if(1&s){const e=t.RV6();t.j41(0,"li",50)(1,"button",55),t.bIt("click",function(){const n=t.eBV(e).$implicit,o=t.XpG(2);return t.Njj(o.goToPage(n))}),t.EFF(2),t.k0s()()}if(2&s){const e=u.$implicit,i=t.XpG(2);t.AVh("active",e===i.currentPage),t.R7$(2),t.JRh(e+1)}}function F(s,u){if(1&s){const e=t.RV6();t.j41(0,"div",48)(1,"div",30),t.EFF(2),t.k0s(),t.j41(3,"nav")(4,"ul",49)(5,"li",50)(6,"button",51),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(n.currentPage-1))}),t.nrm(7,"i",52),t.k0s()(),t.DNE(8,C,3,3,"li",53),t.j41(9,"li",50)(10,"button",51),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.goToPage(n.currentPage+1))}),t.nrm(11,"i",54),t.k0s()()()()()}if(2&s){const e=t.XpG();t.R7$(2),t.E5c(" Showing ",e.currentPage*e.pageSize+1," to ",e.Math.min((e.currentPage+1)*e.pageSize,e.totalElements)," of ",e.totalElements," constituencies "),t.R7$(3),t.AVh("disabled",0===e.currentPage),t.R7$(),t.Y8G("disabled",0===e.currentPage),t.R7$(2),t.Y8G("ngForOf",e.getPageNumbers()),t.R7$(),t.AVh("disabled",e.currentPage===e.totalPages-1),t.R7$(),t.Y8G("disabled",e.currentPage===e.totalPages-1)}}let E=(()=>{class s{constructor(e,i,n,o){this.constituencyService=e,this.authService=i,this.toastService=n,this.router=o,this.constituencies=[],this.searchTerm="",this.currentPage=0,this.pageSize=10,this.totalElements=0,this.totalPages=0,this.sortBy="name",this.sortDir="asc",this.isLoading=!1,this.Math=Math}ngOnInit(){if(!this.authService.isAuthenticated())return this.toastService.error("Authentication Required","Please log in to access this page."),void this.router.navigate(["/login"]);this.loadConstituencies()}loadConstituencies(){this.isLoading=!0,(this.searchTerm?this.constituencyService.searchConstituencies(this.searchTerm,this.currentPage,this.pageSize,this.sortBy,this.sortDir):this.constituencyService.getAllConstituencies(this.currentPage,this.pageSize,this.sortBy,this.sortDir)).subscribe({next:i=>{this.isLoading=!1,i.status?(this.constituencies=i.data,this.totalElements=i.totalElements,this.totalPages=i.totalPages):(this.toastService.error("Error","Failed to load constituencies"),this.constituencies=[])},error:i=>{this.isLoading=!1,console.error("Error loading constituencies:",i),401===i.status||403===i.status?(this.toastService.error("Authentication Error","Your session has expired. Please log in again."),this.router.navigate(["/login"])):this.toastService.error("Error","Failed to load constituencies. Please try again."),this.constituencies=[]}})}onSearch(){this.currentPage=0,this.loadConstituencies()}onPageSizeChange(){this.currentPage=0,this.loadConstituencies()}onSort(e,i){i.preventDefault(),this.sortBy===e?this.sortDir="asc"===this.sortDir?"desc":"asc":(this.sortBy=e,this.sortDir="asc"),this.currentPage=0,this.loadConstituencies()}goToPage(e){e>=0&&e<this.totalPages&&(this.currentPage=e,this.loadConstituencies())}getPageNumbers(){const e=[],n=Math.max(0,this.currentPage-Math.floor(2.5)),o=Math.min(this.totalPages-1,n+5-1);for(let r=n;r<=o;r++)e.push(r);return e}deleteConstituency(e){confirm(`Are you sure you want to delete the constituency "${e.name}"?`)&&this.constituencyService.deleteConstituency(e.uid).subscribe({next:i=>{i.status?(this.toastService.success("Success","Constituency deleted successfully"),this.loadConstituencies()):this.toastService.error("Error","Failed to delete constituency")},error:i=>{console.error("Error deleting constituency:",i),this.toastService.error("Error","Failed to delete constituency. Please try again.")}})}static{this.\u0275fac=function(i){return new(i||s)(t.rXU(h.w),t.rXU(_.u),t.rXU(m.f),t.rXU(d.Ix))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-constituency-list"]],standalone:!0,features:[t.aNF],decls:34,vars:10,consts:[[1,"constituency-list-container"],[1,"card","mb-4"],[1,"card-body"],[1,"row"],[1,"col-md-6"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-search"],["type","text","placeholder","Search constituencies...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-title","mb-0"],[1,"bi","bi-flag","me-2"],[1,"d-flex","align-items-center","gap-2"],["routerLink","/constituencies/create",1,"btn","btn-primary","btn-sm"],[1,"bi","bi-plus","me-1"],[1,"text-muted","me-2"],[1,"form-select","form-select-sm","w-auto",3,"ngModelChange","change","ngModel"],[3,"value"],["class","text-center py-4",4,"ngIf"],["class","text-center py-5",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],[1,"text-center","py-5"],[1,"bi","bi-flag","text-muted",2,"font-size","3rem"],[1,"text-muted","mt-3"],[1,"text-muted"],["routerLink","/constituencies/create",1,"btn","btn-primary"],[1,"bi","bi-plus-circle","me-1"],[1,"table-responsive"],[1,"table","table-hover"],[1,"table-light"],[1,"sortable",3,"click"],[1,"bi"],[4,"ngFor","ngForOf"],[1,"badge","bg-primary"],[1,"badge","bg-warning","text-dark"],[1,"badge","bg-success"],[1,"badge"],["role","group",1,"btn-group","btn-group-sm"],["type","button","title","Edit constituency",1,"btn","btn-outline-primary",3,"routerLink"],[1,"bi","bi-pencil"],["type","button","title","Delete constituency",1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"pagination","pagination-sm","mb-0"],[1,"page-item"],[1,"page-link",3,"click","disabled"],[1,"bi","bi-chevron-left"],["class","page-item",3,"active",4,"ngFor","ngForOf"],[1,"bi","bi-chevron-right"],[1,"page-link",3,"click"]],template:function(i,n){1&i&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),t.nrm(7,"i",7),t.k0s(),t.j41(8,"input",8),t.mxI("ngModelChange",function(r){return t.DH7(n.searchTerm,r)||(n.searchTerm=r),r}),t.bIt("keyup.enter",function(){return n.onSearch()}),t.k0s()()()()()(),t.j41(9,"div",9)(10,"div",10)(11,"h5",11),t.nrm(12,"i",12),t.EFF(13," All Constituencies "),t.k0s(),t.j41(14,"div",13)(15,"a",14),t.nrm(16,"i",15),t.EFF(17," New Constituency "),t.k0s(),t.j41(18,"span",16),t.EFF(19,"Page Size:"),t.k0s(),t.j41(20,"select",17),t.mxI("ngModelChange",function(r){return t.DH7(n.pageSize,r)||(n.pageSize=r),r}),t.bIt("change",function(){return n.onPageSizeChange()}),t.j41(21,"option",18),t.EFF(22,"10"),t.k0s(),t.j41(23,"option",18),t.EFF(24,"25"),t.k0s(),t.j41(25,"option",18),t.EFF(26,"50"),t.k0s(),t.j41(27,"option",18),t.EFF(28,"100"),t.k0s()()()(),t.j41(29,"div",2),t.DNE(30,b,6,0,"div",19)(31,v,9,0,"div",20)(32,f,26,9,"div",21)(33,F,12,10,"div",22),t.k0s()()()),2&i&&(t.R7$(8),t.R50("ngModel",n.searchTerm),t.R7$(12),t.R50("ngModel",n.pageSize),t.R7$(),t.Y8G("value",10),t.R7$(2),t.Y8G("value",25),t.R7$(2),t.Y8G("value",50),t.R7$(2),t.Y8G("value",100),t.R7$(3),t.Y8G("ngIf",n.isLoading),t.R7$(),t.Y8G("ngIf",!n.isLoading&&0===n.constituencies.length),t.R7$(),t.Y8G("ngIf",!n.isLoading&&n.constituencies.length>0),t.R7$(),t.Y8G("ngIf",!n.isLoading&&n.constituencies.length>0))},dependencies:[l.MD,l.Sq,l.bT,l.QX,a.YN,a.xH,a.y7,a.me,a.wz,a.BC,a.vS,d.iI,d.Wk],styles:[".constituency-list-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 1rem}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #dee2e6}.sortable[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}.sortable[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:5px;font-size:.7em}"]})}}return s})()}}]);