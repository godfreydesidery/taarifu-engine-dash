"use strict";(self.webpackChunktaarifu_engine_dash=self.webpackChunktaarifu_engine_dash||[]).push([[297],{297:(P,p,n)=>{n.r(p),n.d(p,{HamletFormComponent:()=>V});var F=n(177),l=n(4341),e=n(4438),C=n(891),j=n(5996),D=n(3446),R=n(4486),H=n(3832),_=n(1069),S=n(5423);function O(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," Hamlet name is required "),e.k0s())}function q(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," Hamlet name must not exceed 100 characters "),e.k0s())}function A(r,s){if(1&r&&(e.j41(0,"option",57),e.EFF(1),e.k0s()),2&r){const i=s.$implicit;e.Y8G("value",i.id),e.R7$(),e.JRh(i.name)}}function M(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," Region is required "),e.k0s())}function U(r,s){if(1&r&&(e.j41(0,"option",57),e.EFF(1),e.k0s()),2&r){const i=s.$implicit;e.Y8G("value",i.id),e.R7$(),e.JRh(i.name)}}function W(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," District is required "),e.k0s())}function w(r,s){if(1&r&&(e.j41(0,"option",57),e.EFF(1),e.k0s()),2&r){const i=s.$implicit;e.Y8G("value",i.id),e.R7$(),e.JRh(i.name)}}function T(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," Ward is required "),e.k0s())}function L(r,s){if(1&r&&(e.j41(0,"option",57),e.EFF(1),e.k0s()),2&r){const i=s.$implicit;e.Y8G("value",i.id),e.R7$(),e.JRh(i.name)}}function $(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," Village is required "),e.k0s())}function y(r,s){1&r&&(e.j41(0,"div",56),e.EFF(1," Headquarters is required "),e.k0s())}function N(r,s){1&r&&e.nrm(0,"span",58)}let V=(()=>{class r{constructor(i,a,t,o,d,u,m,h,c){this.fb=i,this.hamletService=a,this.regionService=t,this.districtService=o,this.wardService=d,this.villageService=u,this.router=m,this.route=h,this.toastService=c,this.isEditMode=!1,this.hamletId=null,this.isLoading=!1,this.regions=[],this.districts=[],this.wards=[],this.villages=[],this.filteredDistricts=[],this.filteredWards=[],this.filteredVillages=[],this.hamletForm=this.fb.group({name:["",[l.k0.required,l.k0.maxLength(100)]],regionId:[null,[l.k0.required]],districtId:[null,[l.k0.required]],wardId:[null,[l.k0.required]],villageId:[null,[l.k0.required]],headquarters:["",[l.k0.required,l.k0.maxLength(100)]],population:[null,[l.k0.min(0)]],areaSqKm:[null,[l.k0.min(0)]],latitude:[null],longitude:[null],executiveOfficer:["",[l.k0.maxLength(100)]],description:["",[l.k0.maxLength(500)]],isActive:[!0]})}ngOnInit(){this.loadRegions(),this.loadDistricts(),this.loadWards(),this.loadVillages(),this.route.paramMap.subscribe(i=>{this.hamletId=i.get("uid"),this.hamletId&&(this.isEditMode=!0,this.loadHamlet(this.hamletId))})}loadRegions(){this.regionService.getAllRegions(0,1e3).subscribe({next:i=>{this.regions=i.data||[]},error:i=>{console.error("Error loading regions:",i)}})}loadDistricts(){this.districtService.getAllDistricts(0,1e3).subscribe({next:i=>{this.districts=i.data||[],this.filteredDistricts=this.districts},error:i=>{console.error("Error loading districts:",i)}})}loadWards(){this.wardService.getAllWards(0,1e3).subscribe({next:i=>{this.wards=i.data||[],this.filteredWards=this.wards},error:i=>{console.error("Error loading wards:",i)}})}loadVillages(){this.villageService.getAllVillages(0,1e3).subscribe({next:i=>{this.villages=i.data||[],this.filteredVillages=this.villages},error:i=>{console.error("Error loading villages:",i)}})}loadHamlet(i){this.isLoading=!0,this.hamletService.getHamletByUid(i).subscribe({next:a=>{if(this.isLoading=!1,a.status){const t=a.data;this.hamletForm.patchValue({name:t.name,regionId:t.regionId,districtId:t.districtId,wardId:t.wardId,villageId:t.villageId,headquarters:t.headquarters,population:t.population,areaSqKm:t.areaSqKm,latitude:t.latitude,longitude:t.longitude,executiveOfficer:t.executiveOfficer,description:t.description,isActive:t.isActive}),this.onRegionChange(),this.onDistrictChange(),this.onWardChange()}},error:a=>{this.isLoading=!1,console.error("Error loading hamlet:",a),this.toastService.error("Error Loading Hamlet",a.error?.message||a.message||"Unknown error"),this.goBack()}})}onRegionChange(){const i=this.hamletForm.get("regionId")?.value;if(i){const a=this.regions.find(t=>t.id===Number(i));a&&this.districtService.getDistrictsByRegionUid(a.uid,0,1e3).subscribe({next:t=>{this.filteredDistricts=t.data||[];const o=this.hamletForm.get("districtId")?.value;o&&!this.filteredDistricts.find(d=>d.id===o)&&(this.hamletForm.patchValue({districtId:null}),this.onDistrictChange())},error:t=>{console.error("Error loading districts for region:",t),this.filteredDistricts=[]}})}else this.filteredDistricts=this.districts,this.hamletForm.patchValue({districtId:null}),this.onDistrictChange()}onDistrictChange(){const i=this.hamletForm.get("districtId")?.value;if(i){const a=this.districts.find(t=>t.id===Number(i));a&&this.wardService.getWardsByDistrictUid(a.uid,0,1e3).subscribe({next:t=>{this.filteredWards=t.data||[];const o=this.hamletForm.get("wardId")?.value;o&&!this.filteredWards.find(d=>d.id===o)&&(this.hamletForm.patchValue({wardId:null}),this.onWardChange())},error:t=>{console.error("Error loading wards for district:",t),this.filteredWards=[]}})}else this.filteredWards=this.wards,this.hamletForm.patchValue({wardId:null}),this.onWardChange()}onWardChange(){const i=this.hamletForm.get("wardId")?.value;if(i){const a=this.wards.find(t=>t.id===Number(i));a&&this.villageService.getVillagesByWardUid(a.uid,0,1e3).subscribe({next:t=>{this.filteredVillages=t.data||[];const o=this.hamletForm.get("villageId")?.value;o&&!this.filteredVillages.find(d=>d.id===o)&&this.hamletForm.patchValue({villageId:null})},error:t=>{console.error("Error loading villages for ward:",t),this.filteredVillages=[]}})}else this.filteredVillages=this.villages,this.hamletForm.patchValue({villageId:null})}onSubmit(){if(this.hamletForm.valid){this.isLoading=!0;const i=this.hamletForm.value;this.isEditMode&&this.hamletId?this.hamletService.updateHamlet(this.hamletId,{name:i.name,villageId:i.villageId,headquarters:i.headquarters,population:i.population,areaSqKm:i.areaSqKm,latitude:i.latitude,longitude:i.longitude,executiveOfficer:i.executiveOfficer,description:i.description,isActive:i.isActive}).subscribe({next:t=>{this.isLoading=!1,t.status&&(this.toastService.success("Hamlet Updated","Hamlet updated successfully!"),this.goBack())},error:t=>{this.isLoading=!1,console.error("Error updating hamlet:",t),this.toastService.error("Error Updating Hamlet",t.error?.message||t.message||"Unknown error")}}):this.hamletService.createHamlet({name:i.name,villageId:i.villageId,headquarters:i.headquarters,population:i.population,areaSqKm:i.areaSqKm,latitude:i.latitude,longitude:i.longitude,executiveOfficer:i.executiveOfficer,description:i.description,isActive:i.isActive}).subscribe({next:t=>{this.isLoading=!1,t.status&&(this.toastService.success("Hamlet Created","Hamlet created successfully!"),this.goBack())},error:t=>{this.isLoading=!1,console.error("Error creating hamlet:",t),this.toastService.error("Error Creating Hamlet",t.error?.message||t.message||"Unknown error")}})}}goBack(){this.router.navigate(["/hamlets"])}static{this.\u0275fac=function(a){return new(a||r)(e.rXU(l.ok),e.rXU(C.x),e.rXU(j.S),e.rXU(D.m),e.rXU(R.U),e.rXU(H.M),e.rXU(_.Ix),e.rXU(_.nX),e.rXU(S.f))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-hamlet-form"]],standalone:!0,features:[e.aNF],decls:179,vars:29,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"h3","mb-1"],[1,"text-muted"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"bi","bi-arrow-left","me-1"],[1,"row"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"bi","bi-house-door-fill","me-2"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"col-md-6"],[1,"mb-3"],["for","name",1,"form-label"],[1,"text-danger"],["type","text","id","name","formControlName","name","placeholder","Enter hamlet name",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","regionId",1,"form-label"],["id","regionId","formControlName","regionId",1,"form-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","districtId",1,"form-label"],["id","districtId","formControlName","districtId",1,"form-select",3,"change"],["for","wardId",1,"form-label"],["id","wardId","formControlName","wardId",1,"form-select",3,"change"],["for","villageId",1,"form-label"],["id","villageId","formControlName","villageId",1,"form-select"],["for","headquarters",1,"form-label"],["type","text","id","headquarters","formControlName","headquarters","placeholder","Enter headquarters",1,"form-control"],["for","population",1,"form-label"],["type","number","id","population","formControlName","population","min","0","placeholder","Enter population",1,"form-control"],["for","areaSqKm",1,"form-label"],["type","number","id","areaSqKm","formControlName","areaSqKm","min","0","step","0.01","placeholder","Enter area in square kilometers",1,"form-control"],["for","latitude",1,"form-label"],["type","number","id","latitude","formControlName","latitude","step","0.000001","placeholder","Enter latitude",1,"form-control"],["for","longitude",1,"form-label"],["type","number","id","longitude","formControlName","longitude","step","0.000001","placeholder","Enter longitude",1,"form-control"],["for","executiveOfficer",1,"form-label"],["type","text","id","executiveOfficer","formControlName","executiveOfficer","placeholder","Enter executive officer name",1,"form-control"],[1,"form-label"],[1,"form-check","form-switch"],["type","checkbox","id","isActive","formControlName","isActive",1,"form-check-input"],["for","isActive",1,"form-check-label"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","3","placeholder","Enter hamlet description",1,"form-control"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],[1,"col-lg-4"],[1,"bi","bi-info-circle","me-2"],[1,"list-unstyled","small","text-muted"],[1,"mt-3"],[1,"invalid-feedback"],[3,"value"],["role","status",1,"spinner-border","spinner-border-sm","me-2"]],template:function(a,t){if(1&a&&(e.j41(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),e.EFF(4),e.k0s(),e.j41(5,"p",3),e.EFF(6),e.k0s()(),e.j41(7,"button",4),e.bIt("click",function(){return t.goBack()}),e.nrm(8,"i",5),e.EFF(9," Back "),e.k0s()(),e.j41(10,"div",6)(11,"div",7)(12,"div",8)(13,"div",9)(14,"h5",10),e.nrm(15,"i",11),e.EFF(16," Hamlet Information "),e.k0s()(),e.j41(17,"div",12)(18,"form",13),e.bIt("ngSubmit",function(){return t.onSubmit()}),e.j41(19,"div",6)(20,"div",14)(21,"div",15)(22,"label",16),e.EFF(23,"Hamlet Name "),e.j41(24,"span",17),e.EFF(25,"*"),e.k0s()(),e.nrm(26,"input",18),e.DNE(27,O,2,0,"div",19)(28,q,2,0,"div",19),e.k0s()(),e.j41(29,"div",14)(30,"div",15)(31,"label",20),e.EFF(32,"Region "),e.j41(33,"span",17),e.EFF(34,"*"),e.k0s()(),e.j41(35,"select",21),e.bIt("change",function(){return t.onRegionChange()}),e.j41(36,"option",22),e.EFF(37,"Select a region"),e.k0s(),e.DNE(38,A,2,2,"option",23),e.k0s(),e.DNE(39,M,2,0,"div",19),e.k0s()()(),e.j41(40,"div",6)(41,"div",14)(42,"div",15)(43,"label",24),e.EFF(44,"District "),e.j41(45,"span",17),e.EFF(46,"*"),e.k0s()(),e.j41(47,"select",25),e.bIt("change",function(){return t.onDistrictChange()}),e.j41(48,"option",22),e.EFF(49,"Select a district"),e.k0s(),e.DNE(50,U,2,2,"option",23),e.k0s(),e.DNE(51,W,2,0,"div",19),e.k0s()(),e.j41(52,"div",14)(53,"div",15)(54,"label",26),e.EFF(55,"Ward "),e.j41(56,"span",17),e.EFF(57,"*"),e.k0s()(),e.j41(58,"select",27),e.bIt("change",function(){return t.onWardChange()}),e.j41(59,"option",22),e.EFF(60,"Select a ward"),e.k0s(),e.DNE(61,w,2,2,"option",23),e.k0s(),e.DNE(62,T,2,0,"div",19),e.k0s()()(),e.j41(63,"div",6)(64,"div",14)(65,"div",15)(66,"label",28),e.EFF(67,"Village "),e.j41(68,"span",17),e.EFF(69,"*"),e.k0s()(),e.j41(70,"select",29)(71,"option",22),e.EFF(72,"Select a village"),e.k0s(),e.DNE(73,L,2,2,"option",23),e.k0s(),e.DNE(74,$,2,0,"div",19),e.k0s()(),e.j41(75,"div",14)(76,"div",15)(77,"label",30),e.EFF(78,"Headquarters "),e.j41(79,"span",17),e.EFF(80,"*"),e.k0s()(),e.nrm(81,"input",31),e.DNE(82,y,2,0,"div",19),e.k0s()()(),e.j41(83,"div",6)(84,"div",14)(85,"div",15)(86,"label",32),e.EFF(87,"Population"),e.k0s(),e.nrm(88,"input",33),e.k0s()(),e.j41(89,"div",14)(90,"div",15)(91,"label",34),e.EFF(92,"Area (km\xb2)"),e.k0s(),e.nrm(93,"input",35),e.k0s()()(),e.j41(94,"div",6)(95,"div",14)(96,"div",15)(97,"label",36),e.EFF(98,"Latitude"),e.k0s(),e.nrm(99,"input",37),e.k0s()(),e.j41(100,"div",14)(101,"div",15)(102,"label",38),e.EFF(103,"Longitude"),e.k0s(),e.nrm(104,"input",39),e.k0s()()(),e.j41(105,"div",6)(106,"div",14)(107,"div",15)(108,"label",40),e.EFF(109,"Executive Officer"),e.k0s(),e.nrm(110,"input",41),e.k0s()(),e.j41(111,"div",14)(112,"div",15)(113,"label",42),e.EFF(114,"Status"),e.k0s(),e.j41(115,"div",43),e.nrm(116,"input",44),e.j41(117,"label",45),e.EFF(118," Active "),e.k0s()()()()(),e.j41(119,"div",15)(120,"label",46),e.EFF(121,"Description"),e.k0s(),e.nrm(122,"textarea",47),e.k0s(),e.j41(123,"div",48)(124,"button",49),e.bIt("click",function(){return t.goBack()}),e.EFF(125," Cancel "),e.k0s(),e.j41(126,"button",50),e.DNE(127,N,1,0,"span",51),e.EFF(128),e.k0s()()()()()(),e.j41(129,"div",52)(130,"div",8)(131,"div",9)(132,"h6",10),e.nrm(133,"i",53),e.EFF(134," Help & Guidelines "),e.k0s()(),e.j41(135,"div",12)(136,"h6"),e.EFF(137,"Required Fields"),e.k0s(),e.j41(138,"ul",54)(139,"li"),e.EFF(140,"\u2022 Hamlet Name"),e.k0s(),e.j41(141,"li"),e.EFF(142,"\u2022 Region"),e.k0s(),e.j41(143,"li"),e.EFF(144,"\u2022 District"),e.k0s(),e.j41(145,"li"),e.EFF(146,"\u2022 Ward"),e.k0s(),e.j41(147,"li"),e.EFF(148,"\u2022 Village"),e.k0s(),e.j41(149,"li"),e.EFF(150,"\u2022 Headquarters"),e.k0s()(),e.j41(151,"h6",55),e.EFF(152,"Optional Fields"),e.k0s(),e.j41(153,"ul",54)(154,"li"),e.EFF(155,"\u2022 Population"),e.k0s(),e.j41(156,"li"),e.EFF(157,"\u2022 Area (km\xb2)"),e.k0s(),e.j41(158,"li"),e.EFF(159,"\u2022 Coordinates (Latitude/Longitude)"),e.k0s(),e.j41(160,"li"),e.EFF(161,"\u2022 Executive Officer"),e.k0s(),e.j41(162,"li"),e.EFF(163,"\u2022 Description"),e.k0s()(),e.j41(164,"h6",55),e.EFF(165,"Tips"),e.k0s(),e.j41(166,"ul",54)(167,"li"),e.EFF(168,"\u2022 Select location hierarchy in order"),e.k0s(),e.j41(169,"li"),e.EFF(170,"\u2022 Use official hamlet names"),e.k0s(),e.j41(171,"li"),e.EFF(172,"\u2022 Headquarters should be the main settlement"),e.k0s(),e.j41(173,"li"),e.EFF(174,"\u2022 Use precise coordinates for mapping"),e.k0s(),e.j41(175,"li"),e.EFF(176,"\u2022 Population should be current estimates"),e.k0s(),e.j41(177,"li"),e.EFF(178,"\u2022 Keep descriptions concise and informative"),e.k0s()()()()()()()),2&a){let o,d,u,m,h,c,E,g,b,f,k,v,I;e.R7$(4),e.JRh(t.isEditMode?"Edit Hamlet":"Create Hamlet"),e.R7$(2),e.JRh(t.isEditMode?"Update hamlet information":"Add a new hamlet to the system"),e.R7$(12),e.Y8G("formGroup",t.hamletForm),e.R7$(8),e.AVh("is-invalid",(null==(o=t.hamletForm.get("name"))?null:o.invalid)&&(null==(o=t.hamletForm.get("name"))?null:o.touched)),e.R7$(),e.Y8G("ngIf",null==(d=t.hamletForm.get("name"))?null:d.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(u=t.hamletForm.get("name"))?null:u.hasError("maxlength")),e.R7$(7),e.AVh("is-invalid",(null==(m=t.hamletForm.get("regionId"))?null:m.invalid)&&(null==(m=t.hamletForm.get("regionId"))?null:m.touched)),e.R7$(3),e.Y8G("ngForOf",t.regions),e.R7$(),e.Y8G("ngIf",null==(h=t.hamletForm.get("regionId"))?null:h.hasError("required")),e.R7$(8),e.AVh("is-invalid",(null==(c=t.hamletForm.get("districtId"))?null:c.invalid)&&(null==(c=t.hamletForm.get("districtId"))?null:c.touched)),e.R7$(3),e.Y8G("ngForOf",t.filteredDistricts),e.R7$(),e.Y8G("ngIf",null==(E=t.hamletForm.get("districtId"))?null:E.hasError("required")),e.R7$(7),e.AVh("is-invalid",(null==(g=t.hamletForm.get("wardId"))?null:g.invalid)&&(null==(g=t.hamletForm.get("wardId"))?null:g.touched)),e.R7$(3),e.Y8G("ngForOf",t.filteredWards),e.R7$(),e.Y8G("ngIf",null==(b=t.hamletForm.get("wardId"))?null:b.hasError("required")),e.R7$(8),e.AVh("is-invalid",(null==(f=t.hamletForm.get("villageId"))?null:f.invalid)&&(null==(f=t.hamletForm.get("villageId"))?null:f.touched)),e.R7$(3),e.Y8G("ngForOf",t.filteredVillages),e.R7$(),e.Y8G("ngIf",null==(k=t.hamletForm.get("villageId"))?null:k.hasError("required")),e.R7$(7),e.AVh("is-invalid",(null==(v=t.hamletForm.get("headquarters"))?null:v.invalid)&&(null==(v=t.hamletForm.get("headquarters"))?null:v.touched)),e.R7$(),e.Y8G("ngIf",null==(I=t.hamletForm.get("headquarters"))?null:I.hasError("required")),e.R7$(44),e.Y8G("disabled",t.hamletForm.invalid||t.isLoading),e.R7$(),e.Y8G("ngIf",t.isLoading),e.R7$(),e.SpI(" ",t.isLoading?"Saving...":t.isEditMode?"Update Hamlet":"Create Hamlet"," ")}},dependencies:[F.MD,F.Sq,F.bT,l.X1,l.qT,l.xH,l.y7,l.me,l.Q0,l.Zm,l.wz,l.BC,l.cb,l.VZ,l.j4,l.JD],styles:[".container-fluid[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 1rem}.card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #dee2e6}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#495057}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}"]})}}return r})()}}]);